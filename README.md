# MCP Email Service

æ”¯æŒå¤šé‚®ç®±è´¦æˆ·ç»Ÿä¸€ç®¡ç†çš„ MCP é‚®ä»¶æœåŠ¡ã€‚å¯åŒæ—¶ç®¡ç†163é‚®ç®±ã€Gmailã€QQé‚®ç®±ç­‰ï¼Œè§£å†³å¤šé‚®ç®±ç®¡ç†éš¾é¢˜ã€‚

## ğŸŒŸ æ”¯æŒçš„é‚®ç®±æœåŠ¡

### å®Œå…¨æ”¯æŒçš„é‚®ç®±
- **163é‚®ç®±** (mail.163.com / mail.126.com) - ä¸­å›½æœ€æµè¡Œçš„é‚®ç®±æœåŠ¡ä¹‹ä¸€
  - âœ… æ”¯æŒæˆæƒç ç™»å½•
  - âœ… è‡ªåŠ¨å¤„ç†ä¸­æ–‡æ–‡ä»¶å¤¹åç§°
  - âœ… é˜²æ­¢"ä¸å®‰å…¨ç™»å½•"æç¤º
  
- **QQé‚®ç®±** (mail.qq.com) - è…¾è®¯é‚®ç®±æœåŠ¡
  - âœ… æ”¯æŒæˆæƒç ç™»å½•
  - âœ… æ”¯æŒæ‰€æœ‰æ–‡ä»¶å¤¹è®¿é—®
  - âœ… è‡ªåŠ¨è¯†åˆ«åƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹
  
- **Gmail** (mail.google.com) - Googleé‚®ç®±æœåŠ¡
  - âœ… æ”¯æŒåº”ç”¨ä¸“ç”¨å¯†ç 
  - âœ… æ”¯æŒæ ‡ç­¾ç³»ç»Ÿ
  - âœ… å®Œæ•´çš„æœç´¢åŠŸèƒ½

### å…¶ä»–æ”¯æŒçš„é‚®ç®±
- **Outlook/Hotmail** - Microsofté‚®ç®±æœåŠ¡
- **è‡ªå®šä¹‰IMAPé‚®ç®±** - æ”¯æŒä»»ä½•æ ‡å‡†IMAPåè®®çš„é‚®ç®±

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- ğŸŒ **å¤šè´¦æˆ·ç®¡ç†** - ç»Ÿä¸€æŸ¥çœ‹æ‰€æœ‰é‚®ç®±çš„é‚®ä»¶
- ğŸ“§ **é‚®ä»¶æ“ä½œ** - æŸ¥çœ‹ã€æ ‡è®°ã€åˆ é™¤ã€ç§»åŠ¨ã€å‘é€
- ğŸ” **é‚®ä»¶æœç´¢** - æŒ‰ä¸»é¢˜ã€å‘ä»¶äººã€æ—¥æœŸç­‰æœç´¢
- ğŸ“ **é™„ä»¶ç®¡ç†** - æŸ¥çœ‹å’Œä¸‹è½½é‚®ä»¶é™„ä»¶
- ğŸš€ **æ‰¹é‡æ“ä½œ** - æ‰¹é‡æ ‡è®°å·²è¯»ã€åˆ é™¤ç­‰
- ğŸ“ **æ–‡ä»¶å¤¹ç®¡ç†** - æŸ¥çœ‹å’Œç®¡ç†é‚®ç®±æ–‡ä»¶å¤¹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…

éœ€è¦ Python 3.11+ å’Œ [UV](https://github.com/astral-sh/uv) åŒ…ç®¡ç†å™¨ã€‚

```bash
# å…‹éš†é¡¹ç›®
git clone <repo-url>
cd mcp-email-service

# å®‰è£…ä¾èµ–
uv sync
```

### 2. é…ç½®é‚®ç®±

è¿è¡Œé…ç½®å·¥å…·æ·»åŠ é‚®ç®±è´¦æˆ·ï¼š

```bash
uv run python setup.py
```

é€‰æ‹©æ“ä½œï¼š
1. æ·»åŠ é‚®ç®±è´¦æˆ·
2. æŸ¥çœ‹æ‰€æœ‰è´¦æˆ·  
3. åˆ é™¤è´¦æˆ·
4. è®¾ç½®é»˜è®¤è´¦æˆ·
5. **æµ‹è¯•è¿æ¥**ï¼ˆæ¨èï¼‰
6. ä¿å­˜å¹¶é€€å‡º

#### é‚®ç®±é…ç½®è¯´æ˜

| é‚®ç®±ç±»å‹ | é…ç½®æ­¥éª¤ | æ³¨æ„äº‹é¡¹ |
|---------|---------|---------|
| **163é‚®ç®±** | ç™»å½• mail.163.com â†’ è®¾ç½® â†’ å¼€å¯IMAP â†’ è·å–æˆæƒç  | âš ï¸ ä½¿ç”¨æˆæƒç ï¼Œä¸æ˜¯å¯†ç  |
| **Gmail** | å¼€å¯ä¸¤æ­¥éªŒè¯ â†’ [ç”Ÿæˆåº”ç”¨å¯†ç ](https://myaccount.google.com/apppasswords) | éœ€è¦åº”ç”¨ä¸“ç”¨å¯†ç  |
| **QQé‚®ç®±** | è®¾ç½® â†’ è´¦æˆ· â†’ å¼€å¯IMAP â†’ ç”Ÿæˆæˆæƒç  | ä½¿ç”¨æˆæƒç  |
| **Outlook** | ç›´æ¥ä½¿ç”¨é‚®ç®±å¯†ç  | ä¸€èˆ¬æ— éœ€ç‰¹æ®Šè®¾ç½® |

### 3. æµ‹è¯•è¿æ¥

é…ç½®å®Œæˆåæµ‹è¯•è¿æ¥ï¼š

```bash
# ä½¿ç”¨é…ç½®å·¥å…·
uv run python setup.py
# é€‰æ‹© "5. æµ‹è¯•è¿æ¥"

# æˆ–ä½¿ç”¨ç‹¬ç«‹è„šæœ¬
uv run python test_connection.py
```

### 4. é›†æˆåˆ° MCP å®¢æˆ·ç«¯

åœ¨ MCP å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```json
{
    "mcpServers": {
        "mcp-email-service": {
            "command": "/ä½ çš„è·¯å¾„/mcp-email-service/run.sh",
            "args": []
        }
    }
}
```

é‡å¯ MCP å®¢æˆ·ç«¯å³å¯ä½¿ç”¨ã€‚

## ğŸ“‹ å¯ç”¨å‘½ä»¤

### åŸºç¡€åŠŸèƒ½
| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|-----|------|-----|
| `check_connection` | æ£€æŸ¥æ‰€æœ‰é‚®ç®±è¿æ¥ | `check_connection` |
| `list_emails` | åˆ—å‡ºé‚®ä»¶ï¼ˆé»˜è®¤æœªè¯»ï¼‰ | `list_emails` |
| `get_email_detail` | æŸ¥çœ‹é‚®ä»¶è¯¦æƒ… | `get_email_detail with email_id="123"` |
| `search_emails` | æœç´¢é‚®ä»¶ | `search_emails with query="ä¼šè®®"` |

### é‚®ä»¶æ“ä½œ
| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|-----|------|-----|
| `mark_email_read` | æ ‡è®°å·²è¯» | `mark_email_read with email_id="123"` |
| `mark_email_unread` | æ ‡è®°æœªè¯» | `mark_email_unread with email_id="123"` |
| `flag_email` | æ·»åŠ æ˜Ÿæ ‡ | `flag_email with email_id="123"` |
| `delete_email` | åˆ é™¤é‚®ä»¶ | `delete_email with email_id="123"` |

### æ‰¹é‡æ“ä½œ
| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|-----|------|-----|
| `batch_mark_read` | æ‰¹é‡æ ‡è®°å·²è¯» | `batch_mark_read with email_ids=["1", "2", "3"]` |
| `batch_delete_emails` | æ‰¹é‡åˆ é™¤ | `batch_delete_emails with email_ids=["1", "2"]` |
| `batch_move_to_trash` | æ‰¹é‡ç§»åˆ°åƒåœ¾ç®± | `batch_move_to_trash with email_ids=["1", "2"]` |

### é«˜çº§åŠŸèƒ½
| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|-----|------|-----|
| `send_email` | å‘é€é‚®ä»¶ | `send_email with to=["a@b.com"] subject="Hi" body="Hello"` |
| `reply_email` | å›å¤é‚®ä»¶ | `reply_email with email_id="123" body="Thanks"` |
| `list_folders` | åˆ—å‡ºæ–‡ä»¶å¤¹ | `list_folders` |
| `get_email_attachments` | è·å–é™„ä»¶ | `get_email_attachments with email_id="123"` |

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. æŸ¥çœ‹é‚®ä»¶
```bash
# æŸ¥çœ‹æ‰€æœ‰è´¦æˆ·çš„æœªè¯»é‚®ä»¶ï¼ˆé»˜è®¤ï¼‰
list_emails

# æŸ¥çœ‹æ‰€æœ‰é‚®ä»¶
list_emails with unread_only=false

# æŸ¥çœ‹ç‰¹å®šè´¦æˆ·
list_emails with account_id="env_163"

# å¢åŠ è·å–æ•°é‡
list_emails with limit=100
```

### 2. æœç´¢é‚®ä»¶
```bash
# æŒ‰ä¸»é¢˜æœç´¢
search_emails with query="ä¼šè®®" search_in="subject"

# æŒ‰å‘ä»¶äººæœç´¢
search_emails with query="boss@company.com" search_in="from"

# æŒ‰æ—¥æœŸèŒƒå›´æœç´¢
search_emails with date_from="2024-01-01" date_to="2024-01-31"

# åªæœç´¢æœªè¯»
search_emails with query="é‡è¦" unread_only=true
```

### 3. å‘é€é‚®ä»¶
```bash
# å‘é€ç®€å•é‚®ä»¶
send_email with to=["user@example.com"] subject="æµ‹è¯•" body="è¿™æ˜¯æµ‹è¯•é‚®ä»¶"

# å‘é€HTMLé‚®ä»¶
send_email with to=["user@example.com"] subject="æµ‹è¯•" body="<h1>æ ‡é¢˜</h1><p>å†…å®¹</p>" is_html=true

# å¸¦é™„ä»¶
send_email with to=["user@example.com"] subject="æ–‡ä»¶" body="è¯·æŸ¥æ”¶é™„ä»¶" attachments=["/path/to/file.pdf"]
```

## ğŸ”§ å¸¸è§é—®é¢˜

### ç™»å½•å¤±è´¥
- **163é‚®ç®±**ï¼šç¡®è®¤ä½¿ç”¨æˆæƒç è€Œéå¯†ç ï¼Œæ£€æŸ¥æ˜¯å¦å¼€å¯IMAP
- **Gmail**ï¼šéœ€è¦åº”ç”¨ä¸“ç”¨å¯†ç ï¼Œä¸æ˜¯Googleè´¦å·å¯†ç 
- **QQé‚®ç®±**ï¼šéœ€è¦æˆæƒç ï¼Œåœ¨è®¾ç½®ä¸­ç”Ÿæˆ

### è¿æ¥è¶…æ—¶
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- ç¡®è®¤é˜²ç«å¢™å…è®¸IMAPè¿æ¥ï¼ˆç«¯å£993ï¼‰
- æŸäº›å…¬å¸ç½‘ç»œå¯èƒ½é™åˆ¶é‚®ä»¶ç«¯å£

### æ‰¾ä¸åˆ°é‚®ä»¶
- é»˜è®¤åªæ˜¾ç¤ºæœªè¯»é‚®ä»¶ï¼Œä½¿ç”¨ `unread_only=false` æŸ¥çœ‹å…¨éƒ¨
- æ£€æŸ¥é‚®ä»¶æ˜¯å¦åœ¨å…¶ä»–æ–‡ä»¶å¤¹ï¼ˆå¦‚åƒåœ¾ç®±ï¼‰

### å¦‚ä½•æ·»åŠ å¤šä¸ªé‚®ç®±ï¼Ÿ
è¿è¡Œ `uv run python setup.py` å¯ä»¥æ·»åŠ å¤šä¸ªè´¦æˆ·ï¼Œæ‰€æœ‰å‘½ä»¤é»˜è®¤æ“ä½œæ‰€æœ‰è´¦æˆ·ã€‚

## ğŸš€ æ€§èƒ½ä¼˜åŒ–è®¡åˆ’

### è¿‘æœŸä¼˜åŒ–ï¼ˆv1.1.0ï¼‰
- [ ] **æœ¬åœ°SQLiteæ•°æ®åº“åŒæ­¥**
  - å®ç°é‚®ä»¶å…ƒæ•°æ®æœ¬åœ°ç¼“å­˜ï¼Œå¤§å¹…æå‡æŸ¥è¯¢é€Ÿåº¦
  - æ”¯æŒç¦»çº¿æœç´¢å’ŒæŸ¥çœ‹é‚®ä»¶åˆ—è¡¨
  - å¢é‡åŒæ­¥æœºåˆ¶ï¼ŒåªåŒæ­¥æ–°é‚®ä»¶
  - æœ¬åœ°æ“ä½œï¼šæœç´¢ã€åˆ—è¡¨ã€æŸ¥çœ‹è¯¦æƒ…
  - è¿œç¨‹æ“ä½œï¼šæ ‡è®°ã€åˆ é™¤ã€å‘é€ç­‰å†™æ“ä½œ

### å·²å®Œæˆä¼˜åŒ–ï¼ˆv1.0.xï¼‰
- [x] **æ¨¡å—åŒ–æ¶æ„é‡æ„** - ä»å•ä½“æ–‡ä»¶æ‹†åˆ†ä¸ºæ¨¡å—åŒ–è®¾è®¡
- [x] **å¹¶è¡Œå¤„ç†ä¼˜åŒ–** - å¤šè´¦æˆ·å¹¶å‘è·å–ï¼Œæ€§èƒ½æå‡5-10å€
- [x] **è¿æ¥æ± ç®¡ç†** - å¤ç”¨IMAPè¿æ¥ï¼Œå‡å°‘æ¡æ‰‹å¼€é”€
- [x] **æ‰¹é‡æ“ä½œä¼˜åŒ–** - ä½¿ç”¨UIDæ‰¹é‡æ“ä½œï¼Œæé«˜æ•ˆç‡
- [x] **æ™ºèƒ½ç¼“å­˜æœºåˆ¶** - 60ç§’ç¼“å­˜ï¼Œå‡å°‘é‡å¤è¯·æ±‚

### æœªæ¥è§„åˆ’
- [ ] **äº¤äº’å¼é‚®ç®±åº”ç”¨**
  - åŸºäºæœ¬åœ°æ•°æ®åº“çš„Web/æ¡Œé¢å®¢æˆ·ç«¯
  - å®æ—¶é‚®ä»¶æ¨é€é€šçŸ¥
  - é«˜çº§æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½
  
- [ ] **æœºå™¨å­¦ä¹ é›†æˆ**
  - æ™ºèƒ½é‚®ä»¶åˆ†ç±»
  - åƒåœ¾é‚®ä»¶æ£€æµ‹
  - é‡è¦é‚®ä»¶è¯†åˆ«

## ğŸ“ è®¸å¯è¯

MIT License